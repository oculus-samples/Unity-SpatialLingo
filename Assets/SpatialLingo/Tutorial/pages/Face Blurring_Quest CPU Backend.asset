%YAML 1.1
%TAG !u! tag:unity3d.com,2011:
--- !u!114 &11400000
MonoBehaviour:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 0}
  m_Enabled: 1
  m_EditorHideFlags: 0
  m_Script: {fileID: 11500000, guid: 4510294d23d964fe59443526f1ca7c4b, type: 3}
  m_Name: Face Blurring_Quest CPU Backend
  m_EditorClassIdentifier: 
  m_displayName: Quest CPU Backend
  m_hierarchyName: Face Blurring/Quest CPU Backend
  m_context: {fileID: 11400000, guid: 400cf6a22014d2b4c80f5a0b61c2ba92, type: 2}
  m_markdownFile: {fileID: 0}
  m_priority: 1016
  m_overrideMarkdownText: "## Quest CPU Backend\n\nThe `QuestCPUBackend` provides
    a custom inference backend optimized for Quest hardware to prevent frame stalling.\n\n\n###
    The Problem: PhysX Thread Starvation\n\nUnity's Burst job system is used by both
    the Inference Engine and PhysX (physics simulation). On Quest 3, the system is
    configured with 4 Burst worker threads (set via <a href=\"./Assets/SpatialLingo/Activity/SpatialLingoActivity.java\">`SpatialLingoActivity`</a>).\n\nLarge
    convolution operations in the neural network can occupy all available worker
    threads. Since PhysX synchronously waits on the main thread for its Burst jobs
    to complete, this causes frame stalls.\n\n\n### The Solution: Thread Limiting\n\nThe
    `QuestCPUBackendImpl` overrides the convolution operation to limit parallelization:\n\n```csharp\nprivate
    const int MAX_THREADS = 2;\n\nvoid IBackend.Conv(...)\n{\n    // Split work into
    batches that use at most 2 threads\n    job.Schedule(arrayLength, arrayLength
    / MAX_THREADS + 1, fenceBeforeJobStart);\n}\n```\n\nBy limiting convolution jobs
    to 2 threads, at least 2 worker threads remain available for physics, preventing
    main thread stalls.\n\n\n### Why CPU Instead of GPU?\n\nThe convolution layers
    in RetinaFace are too large to complete within the frame budget on Quest GPU.
    Alternative solutions include:\n\n- Reducing input image resolution (requires
    model modification)\n- Using Vulkan async compute API (not implemented by Unity
    Inference Engine)\n\nCPU inference with thread management provides the most practical
    solution for real-time performance.\n\n"
  m_overrideMarkdownRoot: .\Packages\com.meta.utilities.objectclassifier\Documentation~/
